---
output: html_document
---

# Counting

## Birthday Matches

Imagine a room with $k$ people.
Assume that each personâ€™s birthday is equally likely. 
(So no twins, leap years, ...).
Calculate the probability that _two or more people_ have the same birthday.

## Simulation

To simulate the birthday problem, 
use the sample function to choose 23 random birthdays

```{r}
k <- 23
b <- sample(1:365, k, replace = TRUE)
head(table(b))
```

Then simulate $n$ times with a set random seed

```{r}
set.seed(42)
nsims <- 1e4
r <- replicate(nsims, max(table(sample(1:365, k, replace = TRUE))))
sum(r>=2) / nsims
```

Comments: 
-   Randomly choose 23 numbers with replacement between 1 and 365 corresponding to 23 people's birthdays. 
-   Tally the numbers, and check if there is at least 1 match (`max >= 2`)
-   Do this 10,000 times, and count the proportion of matches
-   Above half of simulations have at least 1 match

## Calculation

The probability of at least one birthday match in a group of 23 people
can be calculated from a combinatorial analysis

```{r}
k <- 23
(p_match <- 1 - prod((365-k+1):365)/(365^k))
```

Better yet, 
R has a built in function

```{r}
pbirthday(k)
```

or the number of people to have a match with probability `p`

```{r}
qbirthday(0.5)
```

The function also allows triple, quadruple, ... matches

```{r}
pbirthday(23, coincident = 3)
```


